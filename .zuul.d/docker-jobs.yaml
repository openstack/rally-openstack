- secret:
    name: rally-openstack-dockerhub-credentials
    data:
      username: !encrypted/pkcs1-oaep
        - Lpn4COtSgWZJO5Y6AA/ANJYJEF0PM3I94kBSYouHrzHGY+hriHcjBWZPPMxKvhEjhf14w
          iV/2nomBxZv40CC09znrSHr9KT2gjxZ1rUIfTDnn6USOXsGWWLUN2pKE4GC6Z4SG5kdmo
          Yxd+NwE5xygERFIRUkT052ZYe/1ZFfBunC7iofHLVgCKmQ2/Pg4Q/7EDwPABiHNyUlgL1
          CCXhiK0L75R17klqMDcug4z5/7p0zK9VHp5NvY5y/rPyNWWjatgKMSIBxja7QW4UEeRXi
          8obAzKuYXjoiRAE++pGELTU1aXR3oq6U04Xgl1mwm6Xb5VyYik+OFPq7F8rjwhqd161mN
          LL8ZGXVF6m742LVDLJWDRrKQbC84NdOs7Bx17DZ8Jqbqli3DCagS3kAcsyn8rPByU3BMZ
          NvbyEeZpnte4nuxWZl2eURuktYM88+7PTqinPgxodFCwrY1L3Si7D/bRe3IA1XKKMO5gI
          BsmYpDLX2uz/mdOyxEC/4162rRaYXBVeZrMZTd/a1+z5HGRryxPZ7MMh5kTCzZHseSB7h
          qPOYsdU2zAceijI1+VNg3J6ZzwC/N7uLn6OweyHSca7si3hYXbZpfzDDzo6Z1iJdbLkcR
          fga6LCxc8P8LrosrWqTm/9T4n3d7Jll06qg2jVFV1UO7ItmcmQ2A+V8v4ufPRU=
      password: !encrypted/pkcs1-oaep
        - o20FjF9msjlmzUEY8IUNm8z4QrN4ZEIUtIj38R+ZdtDFKfpaXY4bR3aCEoEXbzXcv91FD
          Zgi6yeNX7gh62dfTzbkijo72s8xfRUeps9FqIS/wnFHhWc64aR8NOaUCdw8W+Up+zeKyM
          GSY7Po3WbitKKxqekTzHOmCpFZcvmvxsvkkDoG249kic9yRFOxn2C8pYYXkUdcoAe+twV
          YBBzk7+IAJKexCH1FdvOr3EfPhNPBlRyYAu6ae8zxxHYSvyw2gGsQ5EPvmkoImqnig2Eh
          EqEgdgSXspsUSt1hLDZwGjKXSQOiXuJSqOs1RHWvqRqBSoSgFUXVtWNBDFLEEZQB6+Hle
          9Qe53NiHssAsr0DVLK81Jai8onWPibhpK9N44DO1x2fnOf6zppHpKhLDXGYRBnOMIquPa
          A50og83WtLOcKAk5mZpLA2vNc+t9Qa0wzIpyvuTeVJrqY7wmNQ1IcaztoSl897JakaE+z
          ITMdA5fProexj1C+zBG8FlcN507rzZoEfUNkc3398uKURE8/BlGYbVP9ut2Zb35JNMQNp
          G8+cu8nOeBxEcq1IP7RlifAFnyPXgRwpsorU/XeeKz4NYEsVXjiX0E6rXlhVsiC2/T3P4
          jEQJAcLa8Puj1tmS+ux+J99yq2W6dYmeFx2v063DHqrC8Cs7+2VIgxRQBGCi9A=


- job:
    name: rally-openstack-docker-build
    parent: build-docker-image
    nodeset: ubuntu-focal
    run: tests/ci/playbooks/docker-build-and-check.yaml
    post-run: tests/ci/playbooks/fetch-html-and-json-reports.yaml
    timeout: 1800
    required-projects:
      - name: openstack/rally
      - name: openstack/rally-openstack
    vars:
      docker_image_version: latest
      docker_repository: "xrally/xrally-openstack"
      rally_plugin_name: "Dummy.openstack"
      rally_package_name: "rally-openstack"
      rally_results_dir: "{{ zuul.project.src_dir }}/.test_results/"

- job:
    name: rally-openstack-docker-build-and-push
    parent: build-docker-image
    nodeset: ubuntu-focal
    run: tests/ci/playbooks/docker-build-check-and-push.yaml
    post-run: tests/ci/playbooks/fetch-html-and-json-reports.yaml
    timeout: 1800
    required-projects:
      - name: openstack/rally
      - name: openstack/rally-openstack
    secrets:
      name: docker_credentials
      secret: rally-openstack-dockerhub-credentials
      pass-to-parent: false
    vars:
      docker_repository: "xrally/xrally-openstack"
      rally_plugin_name: "Dummy.openstack"
      rally_package_name: "rally-openstack"
      rally_results_dir: "{{ zuul.project.src_dir }}/.test_results/"
